---
title: Read xls files using gdata package in R
author: Fei
date: '2020-05-06'
categories:
  - R
tags:
  - data
  - homework
  - xls
slug: read-xls-files
weight: 1
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/datatables-binding/datatables.js"></script>
<link href="/rmarkdown-libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="/rmarkdown-libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="/rmarkdown-libs/dt-core/js/jquery.dataTables.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>


<p>Openxlsx package can read xlsx files, but not xls files. To read xlsx files that contain time records for the online course videos, gdata package should be used.</p>
<pre class="r"><code>filename &lt;- dir(pattern = &quot;*.xls&quot;)
results &lt;- data.frame(row.names = c(&quot;click_times&quot;,&quot;times&quot;,&quot;class&quot;))
for (f in filename) {
  all_data &lt;- read.xls(f)
  my_data &lt;- subset(all_data,all_data[2]==&quot;2019******005&quot;,select = c(3,4))
  if (nrow(my_data)) {
    all_data &lt;- cbind(my_data,substring(f,3,5))
    results &lt;- rbind(results,all_data)
  }

# extract hours minutes and seconds
times &lt;- strsplit(as.character(results$总时长),&quot;[时分秒]&quot;)
# transpose
times &lt;- t(sapply(times,&#39;[&#39;,1:3))
results &lt;- cbind(results,times)
names(results) &lt;- c(&quot;click_times&quot;,&quot;times&quot;,&quot;class&quot;,&quot;hour&quot;,&quot;minute&quot;,&quot;second&quot;)</code></pre>
<p>I have saved the data in the <a href="/post/course_time.RData">.RData</a> file (you can click the link to download it), because the local files are not accessible when Netlify build and host the website.</p>
<pre class="r"><code>load(&quot;../../static/post/course_time.RData&quot;)
library(DT)
datatable(results,rownames = FALSE,
          colnames = c(&#39;Click&#39;, &#39;Times_all&#39;, &#39;Class&#39;, &#39;H&#39;, &#39;M&#39;,&#39;S&#39;),
          caption = htmltools::tags$caption(
            style = &#39;caption-side: top; text-align: center;&#39;,
            htmltools::strong(&#39;Watching times of the classes&#39;)# bold text
          ))</code></pre>
<div id="htmlwidget-1" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"filter":"none","caption":"<caption style=\"caption-side: top; text-align: center;\">\n  <strong>Watching times of the classes<\/strong>\n<\/caption>","data":[[4,2,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,1,1,1,1,1,1,1,1,1,1],["0时48分39秒","0时37分19秒","0时24分49秒","1时8分8秒","0时22分18秒","0时22分18秒","0时28分46秒","0时33分38秒","0时33分38秒","0时57分4秒","0时20分0秒","0时38分29秒","0时32分13秒","1时4分5秒","1时0分10秒","1时25分35秒","1时0分40秒","0时46分19秒","0时49分59秒","0时43分32秒","0时45分16秒","1时21分32秒","1时3分20秒","0时53分0秒","1时22分29秒","0时39分59秒","0时27分29秒","0时20分48秒","0时24分58秒","0时49分59秒","0时50分41秒","0时33分57秒","0时53分45秒"],["1.1","1.2","1.3","1.4","2.1","2.1","2.2","2.3","2.3","2.4","2.5","3.1","3.2","3.3","4.1","4.2","4.3","5.2","5.3","6.1","6.2","6.3","6.4","7.1","7.2","7.3","8.1","8.2","8.3","8.4","9.1","9.2","9.3"],["0","0","0","1","0","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","0","1","0","0","0","0","0","0","0","0"],["48","37","24","8","22","22","28","33","33","57","20","38","32","4","0","25","0","46","49","43","45","21","3","53","22","39","27","20","24","49","50","33","53"],["39","19","49","8","18","18","46","38","38","4","0","29","13","5","10","35","40","19","59","32","16","32","20","0","29","59","29","48","58","59","41","57","45"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Click<\/th>\n      <th>Times_all<\/th>\n      <th>Class<\/th>\n      <th>H<\/th>\n      <th>M<\/th>\n      <th>S<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
