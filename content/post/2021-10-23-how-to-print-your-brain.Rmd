---
title: 3D-print your brain
author: Fei
date: '2021-10-23'
slug: how-to-print-your-brain
categories:
  - Instruction
tags:
  - fMRI
weight: 1
draft: yes
output:
  blogdown::html_page:
    toc: yes
    toc_depth: 2
    number_sections: yes
---

# My little brain

In this National Day holiday, I made a 3D model of my brain and found a company on Taobao to 3D-print it. The finished product is about 10cm × 9cm × 6.5cm in volume (60% of the real size) and about 200g in weight. It looks so nice that every sulcus and gyrus is full of details. It is a really fantastic feeling to hold my brain in my hands.

<img src="/post/2021-10-23-how-to-print-your-brain_files/brain.png" style="width: 80%; display: block; margin:0 auto"/>

Here, I will share what I did so that you can also print your own brain. The whole process is not very complicate, so take it easy.

# Print your brain step-by-step

## Scan your brain

First of all, you need to scan your brain with MRI, getting a T1 anatomical image. In my opinion, participating in a MRI study is the best way to get this image:).

## Reconstruct brain surfaces

Based on the anatomical image, a preliminary brain model can be created by [FreeSurfer](https://surfer.nmr.mgh.harvard.edu/fswiki/FreeSurferWiki). The command `recon-all` performs cortical reconstruction
process, generating serveral brain surfaces. Below is a template of this command. 

```bash
recon-all         \
  -sd subject_dir \ # root directory of the image
  -s subject_name \ # output directory
  -i input_image  \ # filename
  -all            \ # run all processing steps
  -parallel       \ # use more threads to improve speed
  -threads num_of_threads
```

## Convert and edit the surfaces

After the cortical reconstruction process is finished (3-10 hours later), the surfaces (meshes) are stored in the _"surf"_ folder under the _"subject_name"_ folder. What we need are left and right hemispheres of the pial surface, named _"lh.pial"_ and _"rh.pial"_ respectively. To make these surfaces readable by other softwares, we have to run the command `mris_convert`, which converts the surfaces into `stl` format.

```bash
# left hemisphere
mris_convert lh.pial lh.pial.stl
# right hemisphere
mris_convert rh.pial rh.pial.stl
```

To combine and edit these two hemisphere meshes, you need to install [MeshLab](https://www.meshlab.net/#download). Please note that **MeshLab can not undo the changes you have made**. If you make some mistakes, you can only reload the original mesh.

First of all, open the two files obtained from FreeSurfer in MeshLab, click on _"Filters" -> "Mesh Layer" -> "Flatten Visible Layers"_ and apply, then you will see the meshes are merged.

<img src="/post/2021-10-23-how-to-print-your-brain_files/flatten.png" style="width: 80%; display: block; margin:0 auto"/>

The pial surface generated by FreeSurfer is too complex. Click on _"Filters" -> "Remeshing, Simplification, Reconstruction" -> "Quadratic Edge Collapse Decimation"_ and enter an appropriate target number of faces (I used 70000). This process reduces the number of faces, which also smooth the surface.

<img src="/post/2021-10-23-how-to-print-your-brain_files/remesh.png" style="width: 80%; display: block; margin:0 auto"/>

To make the surface smoother, you can click _"Filters" -> "Smoothing, Fairing and Deformation" -> "Laplacian Smooth"_ and click apply.

<img src="/post/2021-10-23-how-to-print-your-brain_files/smooth.png" style="width: 80%; display: block; margin:0 auto"/>

Then you can export the mesh by clicking on _"File" -> "Export Mesh As..."_ and selecting `stl` format.

## Refine the brain model and print it

[Meshmixer](https://www.meshmixer.com/download.html) is a free software providing lots tools that can refine the brain model. Several brushes (e.g. BubbleSmooth, ShrinkSmooth and RobustSmooth) are useful to smooth the mesh and remove spikes.

<img src="/post/2021-10-23-how-to-print-your-brain_files/meshmixer.png" style="width: 100%; display: block; margin:0 auto"/>

As long as the brain model is ready, you can send it to a 3D printing service to print it out!

<img src="/post/2021-10-23-how-to-print-your-brain_files/out.png" style="width: 80%; display: block; margin:0 auto"/>

# Other related tutorials

I could not have printed my brain without the help of these perspicuous blog articles. You can also read these articles.

* [3D Print Your Own Brain](https://www.instructables.com/3D-print-your-own-brain/)
* [How to 3D-print your brain](https://nikkimarinsek.com/blog/how-to-3d-print-your-brain)
* [3d需要学linux_我的脑子—从核磁共振图像到3D打印](https://blog.csdn.net/weixin_39609527/article/details/112671919)

