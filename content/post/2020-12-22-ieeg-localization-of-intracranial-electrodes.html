---
title: 'iEEG: Localization of intracranial electrodes'
author: Fei
date: '2020-12-22'
slug: ieeg-localization-of-intracranial-electrodes
categories:
  - reading
tags:
  - data
weight: 1
draft: yes
output:
  blogdown::html_page:
    toc: yes
    toc_depth: 3
    number_sections: yes
---


<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#overview"><span class="toc-section-number">2</span> Overview</a></li>
<li><a href="#preprocessing-of-mri-image"><span class="toc-section-number">3</span> Preprocessing of MRI image</a></li>
<li><a href="#preprocessing-of-ct-image"><span class="toc-section-number">4</span> Preprocessing of CT image</a></li>
<li><a href="#fusion-of-the-ct-with-the-mri"><span class="toc-section-number">5</span> Fusion of the CT with the MRI</a></li>
<li><a href="#electrodes-placement"><span class="toc-section-number">6</span> Electrodes placement</a></li>
<li><a href="#anatomical-labeling"><span class="toc-section-number">7</span> Anatomical labeling</a></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>This is a simple tutorial for electrodes localization. For more information and examples, please refer to <a href="https://www.fieldtriptoolbox.org/tutorial/human_ecog/">Fieldtrip tutorials</a>. Matlab, <a href="https://www.fil.ion.ucl.ac.uk/spm/software/download/">SPM</a>, and <a href="https://www.fieldtriptoolbox.org/download.php">Fieldtrip</a> are requied for this procedure. After adding the root directory to searching path, you need to initialize Filedtrip toolbox by running the command <code>ft_defaults</code> as well. It is convenient to add this command to startup.m, so that it will be executed automatically when starting Matlab.</p>
</div>
<div id="overview" class="section level1">
<h1><span class="header-section-number">2</span> Overview</h1>
</div>
<div id="preprocessing-of-mri-image" class="section level1">
<h1><span class="header-section-number">3</span> Preprocessing of MRI image</h1>
</div>
<div id="preprocessing-of-ct-image" class="section level1">
<h1><span class="header-section-number">4</span> Preprocessing of CT image</h1>
<p><img src="/post/2020-12-22-ieeg-localization-of-intracranial-electrodes_files/spm.png" style="width: 50%; display: block; margin:0 auto"/>
<!-- ![](/post/2020-12-22-ieeg-localization-of-intracranial-electrodes_files/spm.png) --></p>
<p><img src="/post/2020-12-22-ieeg-localization-of-intracranial-electrodes_files/display_after.png" style="width: 90%; display: block; margin:0 auto"/>
<!-- ![](/post/2020-12-22-ieeg-localization-of-intracranial-electrodes_files/display_after.png) --></p>
</div>
<div id="fusion-of-the-ct-with-the-mri" class="section level1">
<h1><span class="header-section-number">5</span> Fusion of the CT with the MRI</h1>
</div>
<div id="electrodes-placement" class="section level1">
<h1><span class="header-section-number">6</span> Electrodes placement</h1>
<p>Detect the weighted peak (<code>cfg.magtype = peakweighted</code>) around 3 (<code>cfg.magradius = 3</code>) pixels.
# Volume-based registration
<a href="http://nist.mni.mcgill.ca/?p=974">Pediatric atlases</a></p>
</div>
<div id="anatomical-labeling" class="section level1">
<h1><span class="header-section-number">7</span> Anatomical labeling</h1>
<pre class="matlab"><code>% load coordinates
load([filepath &#39;/&#39; subjID &#39;_elec_mni_fv.mat&#39;]);
[ftver, ftpath] = ft_version;
% use brainnetome atlas
atlas = ft_read_atlas([ftpath filesep &#39;template/atlas/brainnetome/BNA_MPM_thr25_1.25mm.nii&#39;]);
cfg            = [];
cfg.roi        = elec_mni_fv.chanpos(:,:);
cfg.atlas      = atlas;
cfg.output     = &#39;multiple&#39;;
labels = ft_volumelookup(cfg, atlas);

% save labels to the cell &quot;position&quot;
len=length(labels);
position=cell(len,1);
for i=1:len
    [~, indx] = max(labels(i).count);
    position{i}=labels(i).name(indx);
end</code></pre>
<p>Brainnetome atlas seems more accurate than AAL atlas.</p>
</div>
